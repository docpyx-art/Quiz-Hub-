<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Verbal – Test 9</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #fff;
  padding-bottom: 100px;
}

.top-bar {
  padding: 12px 20px;
  border-bottom: 1px solid #ccc;
  font-weight: bold;
}

.container {
  display: flex;
  flex-grow: 1;
}

.left, .right {
  width: 50%;
  padding: 30px;
  box-sizing: border-box;
}

.divider {
  width: 1px;
  background: #ccc;
  height: calc(100vh - 60px);
}

/* ✅ TRUE LEFT ALIGN (no preserved indents) */
.passage {
  font-size: 16px;
  line-height: 1.6;
  text-align: left;
  white-space: normal;
}

#stem {
  text-align: left;
  margin-bottom: 10px;
}

.options {
  text-align: left;
}

.qbox {
  padding: 6px 14px;
  border: 2px solid #000;
  display: inline-block;
  margin-bottom: 15px;
  font-weight: bold;
}

.options label {
  display: block;
  margin: 10px 0;
  padding: 6px;
  cursor: pointer;
  border-radius: 4px;
}

.correct { background: #d4edda; }
.incorrect { background: #f8d7da; }

/* Bottom bar */
.bottom-bar {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  width: 100%;
  background: #2f3e46;
  padding: 10px 20px;
  position: fixed;
  bottom: 0;
  left: 0;
  box-sizing: border-box;
  color: #fff;
  gap: 10px;
}

button {
  padding: 9px 20px;
  border: none;
  cursor: pointer;
  border-radius: 4px;
  color: #fff;
  font-weight: bold;
}

.btn-answer { background: #3a5a98; }
.btn-nav { background: #556d98; }

/* Question panel */
.qpanelCollapsed {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  padding: 6px 12px;
  cursor: pointer;
  background: #ff6f61;
  color: #fff;
  border-radius: 4px;
  font-weight: bold;
  display: flex;
  align-items: center;
  z-index: 11;
  font-size: 13px;
}

.qpanelExpanded {
  display: none;
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  padding: 10px;
  border-radius: 6px;
  background: #1a1a1a;
  color: #fff;
  max-width: 800px;
  overflow-y: auto;
  font-size: 14px;
  text-align: center;
  z-index: 10;
  max-height: 300px;
}

.qgrid {
  display: grid;
  grid-template-columns: repeat(8, 1fr);
  gap: 6px;
  justify-content: center;
  margin-top: 5px;
}

.qnum-box {
  padding: 8px;
  text-align: center;
  cursor: pointer;
  border-radius: 4px;
  background: #333;
  color: #fff;
  font-weight: bold;
}

.qnum-box.attempted { background: #ff6f61; }
.qnum-box:hover { opacity: 0.8; }

/* Mobile */
@media (max-width: 768px) {
  body { padding-bottom: 180px; }
  .container { flex-direction: column; }
  .left, .right { width: 100%; padding: 15px; }
  .divider { display: none; }

  .bottom-bar {
    flex-direction: column;
    gap: 8px;
    padding: 10px;
  }

  .btn-answer, .btn-nav {
    width: 100%;
    text-align: center;
  }

  .qpanelCollapsed {
    font-size: 12px;
    padding: 5px 10px;
  }

  .qpanelExpanded {
    max-height: 250px;
    font-size: 13px;
    padding: 8px;
  }

  .qgrid { grid-template-columns: repeat(4, 1fr); gap: 4px; }
  .qnum-box { padding: 6px; font-size: 12px; }

  .passage { font-size: 15px; }
  #stem { font-size: 15px; }
  #options label { font-size: 14px; }

  img { max-width: 100%; height: auto; }
}

@media only screen and (max-width: 600px) {
  .container { flex-direction: column; }
  .left, .right { width: 100%; padding: 20px; }
  .divider { display: none; }

  .bottom-bar {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }

  #qpanelCollapsed { left: 10px; bottom: 80px; transform: none; font-size: 12px; }
  #qpanelExpanded  { left: 10px; bottom: 120px; transform: none; max-width: calc(100% - 20px); font-size: 13px; max-height: 250px; }

  .qgrid { grid-template-columns: repeat(4, 1fr); }
  .qnum-box { padding: 6px; font-size: 12px; }
}
</style>
</head>

<body>

<div class="top-bar">Verbal – Test 9</div>

<div class="container">
  <div class="left">
    <div id="passage" class="passage"></div>
  </div>

  <div class="divider"></div>

  <div class="right">
    <div id="qnumBox" class="qbox"></div>
    <div id="stem"></div>
    <div id="options" class="options"></div>
  </div>
</div>

<div class="bottom-bar">
  <button id="answerBtn" class="btn-answer">Show Correct Answer</button>
  <button id="prevBtn" class="btn-nav">Previous</button>
  <button id="nextBtn" class="btn-nav">Next</button>
  <button id="reviewBtn" class="btn-nav" style="background:#28a745;">Go to Review</button>
</div>

<div id="qpanel">
  <div id="qpanelCollapsed" class="qpanelCollapsed">
    <span id="currentQuestionLabel">Question 0 of 0</span>
    <span id="toggleArrow" style="margin-left:6px;">▲</span>
  </div>
  <div id="qpanelExpanded" class="qpanelExpanded">
    <div id="qgrid" class="qgrid"></div>
  </div>
</div>

<script>
const questions = [
{
  num: 251,
  passage: `
<b>Text 1</b><br>
Fossils of the hominin Australopithecus africanus have been found in the Sterkfontein Caves of South Africa, but
<u>assigning an age to the fossils is challenging because of the unreliability of dating methods in this context.</u> The geology
of Sterkfontein has caused soil layers from different periods to mix, impeding stratigraphic dating, and dates cannot be
reliably imputed from those of nearby animal bones since the bones may have been relocated by flooding.
<br><br>
<b>Text 2</b><br>
Archaeologists used new cosmogenic nuclide dating techniques to reevaluate the ages of A. africanus fossils found in
the Sterkfontein Caves. This technique involves analyzing the cosmogenic nucleotides in the breccia—the matrix of rock
fragments immediately surrounding the fossils. The researchers assert that this approach avoids the potential for
misdating associated with assigning ages based on Sterkfontein’s soil layers or animal bones.
`,
  stem: `Based on the texts, how would the researchers in Text 2 most likely respond to the underlined portion in Text 1?`,
  options: {
    A: `They would emphasize the fact that the A. africanus fossils found in the Sterkfontein Caves may have been corrupted in some way over the years.`,
    B: `They would contend that if analyses of surrounding layers and bones in the Sterkfontein Caves were combined, then the dating of the fossils there would be more accurate.`,
    C: `They would argue that their techniques are better suited than other methods to the unique challenges posed by the Sterkfontein Caves.`,
    D: `They would claim that cosmogenic nuclide dating is reliable in the context of the Sterkfontein Caves because it is applied to the fossils directly.`
  },
  answer: "C",
  img: null
},


{
  num: 252,
  passage: `
Dubautia carrii is a species in a family of plants known collectively as the silversword alliance, all of which grow only on
the Hawaiian Islands. Members of this alliance exhibit an extraordinary range of phenotypes, with some species
maturing into vines and others into shrubs and trees. All species in the alliance descended from a single ancestral
tarweed plant that arrived on the islands around 5 million years ago. The tarweed’s descendants diversified into distinct
species as they adapted to live in the wide variety of habitats found on the Hawaiian Islands.
`,
  stem: `Which choice best states the main purpose of the text?`,
  options: {
    A: `To indicate the specific tarweed ancestor of all plants that grow on the Hawaiian Islands and explain why the plants have such varied physical characteristics`,
    B: `To describe the specific habitat where Dubautia carrii are found and identify other plants that share a common ancestor with them`,
    C: `To describe the silversword alliance and explain how the plant family became so varied`,
    D: `To advance the claim that all plants on the Hawaiian Islands are part of the silversword alliance and list possible ancestors of the plants that make up the alliance`
  },
  answer: "C",
  img: null
},

{
  num: 253,
  passage: `
The following text is adapted from Charles Dickens’s 1854 novel <i>Hard Times</i>. Coketown is a fictional town in England.
<br><br>
[Coketown] contained several large streets all very like one another, and many small streets still more like one another,
inhabited by people equally like one another, who all went in and out at the same hours, with the same sound upon the
same pavements, to do the same work, and to whom every day was the same as yesterday and tomorrow, and every year
the counterpart of the last and the next.
`,
  stem: `Which choice best states the main purpose of the text?`,
  options: {
    A: `To emphasize the uniformity of both the town and the people who live there`,
    B: `To explain the limited work opportunities available to the town’s residents`,
    C: `To reveal how the predictability of the town makes it easy for people to lose track of time`,
    D: `To argue that the simplicity of life in the town makes it a pleasant place to live`
  },
  answer: "A",
  img: null
},

{
  num: 254,
  passage: `
<b>Text 1</b><br>
The live music festival business is growing in event size and genre variety. With so many consumer options, organizers
are finding ways to cement festival attendance as a special experience worth sharing. This phenomenon is linked to the
growing “experiential economy,” where many find it gratifying to purchase lived experiences. To ensure a profitable event,
venues need to consider the overall consumer experience, not just the band lineup.
<br><br>
<b>Text 2</b><br>
Music festival appearances are becoming a more important part of musicians’ careers. One factor in this shift is the
rising use of streaming services that allow access to huge numbers of songs for a monthly fee, subsequently reducing
sales of full-length albums. With this shift in consumer behavior, musicians are increasingly dependent on revenue from
live performances.
`,
  stem: `Based on the texts, both authors would most likely agree with which statement?`,
  options: {
    A: `Consumers are more interested in paying subscription fees to stream music than in attending music festivals in person.`,
    B: `Consumers’ growing interest in purchasing experiences is mostly confined to the music industry.`,
    C: `Changing consumer behaviors are leading to changes in music-related businesses.`,
    D: `The rising consumer demand for live music festivals also generates higher demand for music streaming platforms.`
  },
  answer: "C",
  img: null
},

{
  num: 255,
  passage: `
While researching a topic, a student has taken the following notes:
<br><br>
• Marine biologist Camille Jazmin Gaynus studies coral reefs.<br>
• Coral reefs are vital underwater ecosystems that provide habitats to 25% of all marine species.<br>
• Reefs can include up to 8,000 species of fish, such as toadfish, seahorses, and clown triggerfish.<br>
• The Amazon Reef is a coral reef in Brazil.<br>
• It is one of the largest known reefs in the world.
`,
  stem: `The student wants to introduce the scientist and her field of study to a new audience. Which choice most effectively uses relevant information from the notes to accomplish this goal?`,
  options: {
    A: `Located in Brazil, the Amazon Reef is one of the largest known coral reefs in the world.`,
    B: `Marine biologist Camille Jazmin Gaynus studies coral reefs, vital underwater ecosystems that provide homes to 25% of all marine species.`,
    C: `Providing homes to 25% of all marine species, including up to 8,000 species of fish, coral reefs are vital underwater ecosystems and thus of great interest to marine biologists.`,
    D: `As Camille Jazmin Gaynus knows well, coral reefs are vital underwater ecosystems, providing homes to thousands of species of fish.`
  },
  answer: "B",
  img: null
},

{
  num: 256,
  passage: `
While researching a topic, a student has taken the following notes:
<br><br>
• Lighthouses send out crucial light signals to help ships and other watercraft navigate at night.<br>
• Before automation, lighthouses were run by lighthouse keepers.<br>
• Maria Younghans was the lighthouse keeper at Biloxi Light in Mississippi.<br>
• She held this position from 1867 to 1918.<br>
• Flora McNeil was the lighthouse keeper at Bridgeport Breakwater Light in Connecticut.<br>
• She held this position from 1904 to 1920.
`,
  stem: `The student wants to emphasize the order in which the two lighthouse keepers began their careers. Which choice most effectively uses relevant information from the notes to accomplish this goal?`,
  options: {
    A: `From 1867 to 1918, the nighttime waters of Mississippi were more navigable thanks to lighthouse keepers Flora McNeil and Maria Younghans.`,
    B: `Before automation, lighthouse keepers like Maria Younghans and Flora McNeil were crucial to ensuring safe navigation for watercraft.`,
    C: `Flora McNeil began her career as a lighthouse keeper years after Maria Younghans did.`,
    D: `Maria Younghans’s career as a lighthouse keeper ended in 1918, whereas Flora McNeil’s ended in 1920.`
  },
  answer: "C",
  img: null
},

{
  num: 257,
  passage: `
When, in the 1800s, geologists first realized that much of Earth had once been covered by great sheets of ice, some
theorized that the phenomenon was cyclical, occurring at regular intervals. Each Ice Age is so destructive, though, that it
largely erases the geological evidence of its predecessor. ______ geologists were unable to confirm the theory of cyclical
Ice Ages until the 1960s.
`,
  stem: `Which choice completes the text with the most logical transition?`,
  options: { A:`Hence,`, B:`Moreover,`, C:`Nevertheless,`, D:`Next,` },
  answer: "A",
  img: null
},

{
  num: 258,
  passage: `
To discover which fruit varieties were grown in Italy’s Umbria region before the introduction of industrial farming, botanist
Isabella Dalla Ragione often turns to centuries-old lists of cooking ingredients. ______ she analyzes Renaissance
paintings of Umbria, as they can provide accurate representations of fruits that were grown there long ago.
`,
  stem: `Which choice completes the text with the most logical transition?`,
  options: { A:`In sum,`, B:`Instead,`, C:`Thus,`, D:`Additionally,` },
  answer: "D",
  img: null
},

{
  num: 259,
  passage: `
Songbirds learn to respond to and imitate their species’ songs from an early age. With each generation, small differences
are introduced that result in distinct variations—called dialects—among geographically isolated populations of the same
species. A research study examined whether twelve-day-old Ficedula hypoleuca (pied flycatcher) nestlings prefer local
dialects over the unfamiliar dialects of nonlocal F. hypoleuca populations: the more begging calls the nestlings made in
response to a song, the stronger their preference. The researchers found that nestlings produced more begging calls in
response to their own dialect than to nonlocal dialects. Since song preference plays a role in songbird mate selection, the
finding suggests that ______
`,
  stem: `Which choice most logically completes the text?`,
  options: {
    A:`F. hypoleuca nestlings’ preference for their own dialect likely disappears as they mature to promote socialization between different F. hypoleuca populations.`,
    B:`F. hypoleuca nestlings who show an early preference for their own dialect are likely to receive more food from their caretakers than nestlings who show no preferences among any F. hypoleuca dialects.`,
    C:`F. hypoleuca nestlings’ preference for their own dialect likely drives them when they mature to reproduce with other F. hypoleuca from local rather than nonlocal populations.`,
    D:`F. hypoleuca nestlings show a preference for both local F. hypoleuca dialects and the songs of other local songbirds over the songs of nonlocal birds of any species.`
  },
  answer: "C",
  img: null
},

{
  num: 260,
  passage: `
<i>Sense and Sensibility</i> is an 1811 novel by Jane Austen. In the novel, Austen describes Marianne Dashwood’s ability to
persuade others of the rightness of her artistic judgments, as is evident when Marianne visits with John Willoughby, a
potential suitor: ______
`,
  stem: `Which quotation from <i>Sense and Sensibility</i> most effectively illustrates the claim?`,
  options: {
    A:`“Above all, when she heard him declare, that of music and dancing he was passionately fond, she gave him such a look of approbation as secured the largest share of his discourse to herself for the rest of his stay.”`,
    B:`“Their taste was strikingly alike. The same books, the same passages were idolized by each—or if any difference appeared, any objection arose, it lasted no longer than till the force of her arguments and the brightness of her eyes could be displayed.”`,
    C:`“It was only necessary to mention any favourite amusement to engage her to talk. She could not be silent when such points were introduced, and she had neither shyness nor reserve in their discussion.”`,
    D:`“They speedily discovered that their enjoyment of dancing and music was mutual, and that it arose from a general conformity of judgment in all that related to either. Encouraged by this to a further examination of his opinions, she proceeded to question him on the subject of books.”`
  },
  answer: "B",
  img: null
},

{
  num: 261,
  passage: `
<i>O Pioneers!</i> is a 1913 novel by Willa Cather. In the novel, Cather depicts Alexandra Bergson as a person who takes
comfort in understanding the world around her: ______
`,
  stem: `Which quotation from <i>O Pioneers!</i> most effectively illustrates the claim?`,
  options: {
    A:`“She looked fixedly up the bleak street as if she were gathering her strength to face something, as if she were trying with all her might to grasp a situation which, no matter how painful, must be met and dealt with somehow.”`,
    B:`“She had never known before how much the country meant to her. The chirping of the insects down in the long grass had been like the sweetest music. She had felt as if her heart were hiding down there, somewhere, with the quail and the plover and all the little wild things that crooned or buzzed in the sun. Under the long shaggy ridges, she felt the future stirring.”`,
    C:`“Alexandra drove off alone. The rattle of her wagon was lost in the howling of the wind, but her lantern, held firmly between her feet, made a moving point of light along the highway, going deeper and deeper into the dark country.”`,
    D:`“Alexandra drew her shawl closer about her and stood leaning against the frame of the mill, looking at the stars which glittered so keenly through the frosty autumn air. She always loved to watch them, to think of their vastness and distance, and of their ordered march. It fortified her to reflect upon the great operations of nature, and when she thought of the law that lay behind them, she felt a sense of personal security.”`
  },
  answer: "D",
  img: null
},

{
  num: 262,
  passage: `
Neural networks are computer models intended to reflect the organization of human brains and are often used in studies
of brain function. According to an analysis of 11,000 such networks, Rylan Schaeffer and colleagues advise caution when
drawing conclusions about brains from observations of neural networks. They found that when attempting to mimic grid
cells (brain cells used in navigation), while 90% of the networks could accomplish navigation-related tasks, only about
10% of those exhibited any behaviors similar to those of grid cells. <u>But even this approximation of grid-cell activity has
less to do with similarity between the neural networks and biological brains than it does with the rules programmed into
the networks.</u>
`,
  stem: `Which finding, if true, would most directly support the claim in the underlined sentence?`,
  options: {
    A:`The rules that allow for networks to exhibit behaviors like those of grid cells have no equivalent in the function of biological brains.`,
    B:`The networks that do not exhibit behaviors like those of grid cells were nonetheless programmed with rules that had proven useful in earlier neural-network studies.`,
    C:`Neural networks can often accomplish tasks that biological brains do, but they are typically programmed with rules to model multiple types of brain cells simultaneously.`,
    D:`Once a neural network is programmed, it is trained on certain tasks to see if it can independently arrive at processes that are similar to those performed by biological brains.`
  },
  answer: "A",
  img: null
},


{
  num: 263,
  passage: `
Materials scientist Marie-Agathe Charpagne and her colleagues believed they could improve on the multicomponent alloy
NiCoCr, an equal-proportions mixture of nickel (Ni), cobalt (Co), and chromium (Cr), by replacing chromium with
ruthenium ______ the alloy that resulted, NiCoRu, turned out to be an unsuitable replacement for NiCoCr.
`,
  stem: `Which choice completes the text so that it conforms to the conventions of Standard English?`,
  options: { A:`(Ru)`, B:`(Ru) but`, C:`(Ru),`, D:`(Ru), but` },
  answer: "D",
  img: null
},

{
  num: 264,
  passage: `
According to Naomi Nakayama of the University of Edinburgh, the reason seeds from a dying dandelion appear to float in
the air while ______ is that their porous plumes enhance drag, allowing the seeds to stay airborne long enough for the
wind to disperse them throughout the surrounding area.
`,
  stem: `Which choice completes the text so that it conforms to the conventions of Standard English?`,
  options: { A:`falling,`, B:`falling:`, C:`falling;`, D:`falling` },
  answer: "D",
  img: null
},

{
  num: 265,
  passage: `
When they were first discovered in Australia in 1798, duck-billed, beaver-tailed platypuses so defied categorization that
one scientist assigned them the name Ornithorhynchus paradoxus: “paradoxical bird-snout.” The animal, which lays eggs
but also nurses ______ young with milk, has since been classified as belonging to the monotremes group.
`,
  stem: `Which choice completes the text so that it conforms to the conventions of Standard English?`,
  options: { A:`they’re`, B:`their`, C:`its`, D:`it’s` },
  answer: "C",
  img: null
},

{
  num: 266,
  passage: `
Featuring works by the photographers Lola Álvarez Bravo and Else “Yva” Neuländer-Simon, the 2021 exhibition <i>The New
Woman Behind the Camera</i> set out to provide a wide-ranging overview of photography by women in the 1920s through the
______ given the collection’s breadth of more than 120 photos, its efforts were largely successful.
`,
  stem: `Which choice completes the text so that it conforms to the conventions of Standard English?`,
  options: { A:`1950s, and`, B:`1950s and`, C:`1950s`, D:`1950s,` },
  answer: "A",
  img: null
}
];

let currentQ = 0;
let answerShown = false;
let attempted = Array(questions.length).fill(false);
let userAnswers = Array(questions.length).fill(null);

/* ---------- TEXT NORMALIZERS ---------- */

/* For short single-line fields like stem: trim + kill extra whitespace. */
function normalizeInline(s) {
  return (s ?? "")
    .replace(/\r\n/g, "\n")
    .replace(/\n[ \t]+/g, "\n")
    .trim()
    .replace(/\s+/g, " ");
}

/* For passages: remove indentation; keep paragraph breaks only.
   - Collapses single newlines into spaces (fixes unwanted line breaks)
   - Preserves real paragraph breaks (2+ newlines) as <br><br>
   - Leaves any existing <br> tags in your passage strings untouched
*/
function normalizePassageHTML(s) {
  let t = (s ?? "")
    .replace(/\r\n/g, "\n")
    .replace(/\n[ \t]+/g, "\n")
    .trim();

  // Mark paragraph breaks (2+ newlines)
  t = t.replace(/\n{2,}/g, "<<<P>>>");

  // Collapse remaining single newlines into spaces
  t = t.replace(/\n/g, " ");

  // Clean spacing
  t = t.replace(/[ \t]{2,}/g, " ").trim();

  // Restore paragraphs
  t = t.replace(/<<<P>>>/g, "<br><br>");

  return t;
}

function setButtonsEnabled(enabled){
  ["answerBtn","prevBtn","nextBtn","reviewBtn"].forEach(id=>{
    const b=document.getElementById(id);
    b.disabled=!enabled;
    b.style.opacity=enabled?'1':'0.6';
    b.style.cursor=enabled?'pointer':'not-allowed';
  });
}

function loadQuestion() {
  if (questions.length === 0) {
    document.getElementById('passage').innerHTML = 'No questions added yet.';
    document.getElementById('qnumBox').innerText = '—';
    document.getElementById('stem').innerText = '';
    document.getElementById('options').innerHTML = '';
    document.getElementById('answerBtn').innerText = 'Show Correct Answer';
    answerShown = false;
    updateQpanel();
    setButtonsEnabled(false);
    return;
  }

  setButtonsEnabled(true);

  const q = questions[currentQ];

  const passageHTML = normalizePassageHTML(q.passage);
  document.getElementById('passage').innerHTML =
    (q.img ? `<img src="${q.img}" alt="Graph" style="max-width:100%; margin-bottom:10px;"><br>` : '') + passageHTML;

  document.getElementById('qnumBox').innerText = `Q${q.num}`;
  document.getElementById('stem').innerText = normalizeInline(q.stem || "");

  const optionsDiv = document.getElementById('options');
  optionsDiv.innerHTML = '';

  for (const [key, val] of Object.entries(q.options)) {
    const lbl = document.createElement('label');
    lbl.innerHTML = `<input type="radio" name="option" value="${key}"> ${key}. ${val}`;
    const input = lbl.querySelector('input');

    if (userAnswers[currentQ] === key) input.checked = true;

    input.addEventListener('change', () => {
      userAnswers[currentQ] = key;
      attempted[currentQ] = true;
      updateQpanel();
    });

    optionsDiv.appendChild(lbl);
  }

  answerShown = false;
  document.getElementById('answerBtn').innerText = 'Show Correct Answer';
  updateQpanel();
}

function toggleAnswer() {
  const q = questions[currentQ];
  const optionsDiv = document.getElementById('options');

  if (!answerShown){
    for (const input of optionsDiv.querySelectorAll('input')){
      input.parentNode.classList.remove('correct','incorrect');
      if (input.value===q.answer) input.parentNode.classList.add('correct');
      else input.parentNode.classList.add('incorrect');
    }
    document.getElementById('answerBtn').innerText = 'Hide Correct Answer';
    answerShown = true;
  } else {
    for (const input of optionsDiv.querySelectorAll('input')){
      input.parentNode.classList.remove('correct','incorrect');
    }
    document.getElementById('answerBtn').innerText = 'Show Correct Answer';
    answerShown = false;
  }
}

document.getElementById('answerBtn').addEventListener('click', toggleAnswer);
document.getElementById('prevBtn').addEventListener('click', () => { if(currentQ>0) currentQ--; loadQuestion(); });
document.getElementById('nextBtn').addEventListener('click', () => { if(currentQ<questions.length-1) currentQ++; loadQuestion(); });

const collapsed = document.getElementById('qpanelCollapsed');
const expanded = document.getElementById('qpanelExpanded');
collapsed.addEventListener('click', () => { expanded.style.display = expanded.style.display==='block'?'none':'block'; });

function updateQpanel(){
  const grid = document.getElementById('qgrid');
  grid.innerHTML = '';

  questions.forEach((q,i)=>{
    const b = document.createElement('div');
    b.innerText = q.num;
    b.className='qnum-box';
    b.classList.toggle('attempted', attempted[i]);
    b.addEventListener('click',()=>{ currentQ=i; loadQuestion(); expanded.style.display='none'; });
    grid.appendChild(b);
  });

  document.getElementById('currentQuestionLabel').innerText =
    `Question ${questions[currentQ].num} of ${questions.length}`;
}

loadQuestion();

/* Review page */
document.getElementById('reviewBtn').addEventListener('click', () => {
  const mainContent = document.querySelector('.container');
  const bottomBar = document.querySelector('.bottom-bar');
  const qpanel = document.getElementById('qpanel');
  mainContent.style.display = 'none';
  bottomBar.style.display = 'none';
  qpanel.style.display = 'none';

  let reviewDiv = document.getElementById('reviewPage');
  if (!reviewDiv) {
    reviewDiv = document.createElement('div');
    reviewDiv.id = 'reviewPage';
    reviewDiv.style.padding = '20px';
    reviewDiv.style.maxWidth = '600px';
    reviewDiv.style.margin = '0 auto';
    document.body.appendChild(reviewDiv);
  }
  reviewDiv.style.display = 'block';
  reviewDiv.innerHTML = '<h2>Review Questions</h2>';

  const correctCount = userAnswers.filter((ans, idx) => ans === questions[idx].answer).length;
  const totalCount = questions.length;

  const scoreDiv = document.createElement('div');
  scoreDiv.style.fontWeight = 'bold';
  scoreDiv.style.marginBottom = '15px';
  scoreDiv.innerText = `Score: ${correctCount} / ${totalCount}`;
  reviewDiv.appendChild(scoreDiv);

  const ul = document.createElement('ul');
  ul.style.listStyle = 'none';
  ul.style.padding = '0';
  ul.style.display = 'flex';
  ul.style.flexWrap = 'wrap';
  ul.style.gap = '8px';

  questions.forEach((q,i)=>{
    const li = document.createElement('li');
    li.innerText = q.num;
    li.style.padding='8px 12px';
    li.style.border='1px solid #333';
    li.style.borderRadius='4px';
    li.style.cursor='pointer';

    if (userAnswers[i] === null) li.style.background = '#555';
    else if (userAnswers[i] === q.answer) li.style.background = '#28a745';
    else li.style.background = '#dc3545';
    li.style.color='#fff';

    li.addEventListener('click', () => {
      currentQ = i;
      loadQuestion();
      reviewDiv.style.display = 'none';
      mainContent.style.display = 'flex';
      bottomBar.style.display = 'flex';
      qpanel.style.display = 'block';
    });

    ul.appendChild(li);
  });

  reviewDiv.appendChild(ul);

  let backBtn = document.getElementById('backToTestBtn');
  if (!backBtn) {
    backBtn = document.createElement('button');
    backBtn.id = 'backToTestBtn';
    backBtn.innerText = 'Back to Test';
    backBtn.style.background='#556d98';
    backBtn.style.color='#fff';
    backBtn.style.border='none';
    backBtn.style.padding='10px 20px';
    backBtn.style.marginTop='20px';
    backBtn.style.borderRadius='4px';
    backBtn.style.cursor='pointer';
    reviewDiv.appendChild(backBtn);
  }
  backBtn.onclick = () => {
    reviewDiv.style.display = 'none';
    mainContent.style.display = 'flex';
    bottomBar.style.display = 'flex';
    qpanel.style.display = 'block';
  };
});
</script>

</body>
</html>
