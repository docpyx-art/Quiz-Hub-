<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Math – Set 8</title>

<!-- MathJax -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\\(','\\)'], ['$', '$']],
      displayMath: [['\\[','\\]']]
    },
    options: { skipHtmlTags: ['script','noscript','style','textarea','pre','code'] },
    chtml: { scale: 1.25 }
  };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<style>
body { margin:0; font-family:Arial,sans-serif; background:#fff; }

/* ✅ Top bar (flex) so buttons never cover title */
.top-bar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 20px;
  border-bottom:1px solid #ccc;
  font-weight:bold;
}
.top-left{ display:flex; align-items:center; gap:12px; }
.top-right{ display:flex; align-items:center; gap:10px; }

.test-btn{
  padding:6px 12px;
  font-size:14px;
  border-radius:4px;
  border:1px solid #ff6f61;
  background:#fff;
  color:#ff6f61;
  cursor:pointer;
}
.calc-btn{
  padding:6px 12px;
  font-size:14px;
  border-radius:4px;
  border:1px solid #0077cc;
  background:#fff;
  color:#0077cc;
  cursor:pointer;
}

/* Container: single column layout */
.container {
  display:flex;
  flex-direction:column;
  flex-grow:1;
  padding:20px;
  padding-bottom:150px;
}

.passage { font-size:16px; line-height:1.6; white-space:pre-wrap; margin-bottom:20px; }
#stem { margin-bottom:6px; }

.qbox{
  display:inline-block;
  align-self:flex-start;
  padding:4px 8px;
  width:auto;
  text-align:center;
  border:2px solid #000;
  border-radius:4px;
  font-weight:bold;
  font-size:16px;
  margin-bottom:35px;
}

.options label { display:block; margin:10px 0; padding:6px; cursor:pointer; border-radius:4px; }
.correct { background:#d4edda; }
.incorrect { background:#f8d7da; }

/* ✅ Darker radio dot */
.options input[type="radio"]{
  width:20px;
  height:20px;
  transform: translateY(4px);
  accent-color:#000;
}

/* SPR input */
.spr-wrap { margin-top:10px; }
.spr-input {
  width:220px;
  max-width:100%;
  padding:8px 10px;
  font-size:16px;
  border:1px solid #333;
  border-radius:4px;
}
.spr-hint { margin-top:8px; font-size:14px; }

/* ✅ Post-submit result bars (small fills only) */
.resultText{ margin-top:10px; font-size:14px; line-height:1.6; }
.resultLine{ display:inline-block; padding:4px 8px; border-radius:6px; margin:4px 0; }
.yourAns{ background:#f8d7da; color:#000; font-weight:bold; }
.correctAns{ background:#d4edda; color:#000; font-weight:bold; }

/* Bottom bar fixed */
.bottom-bar{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  width:100%;
  background:#2f3e46;
  padding:10px 20px;
  position:fixed;
  bottom:0; left:0;
  box-sizing:border-box;
  color:#fff;
  gap:10px;
  z-index:20;
}

button { padding:9px 20px; border:none; cursor:pointer; border-radius:4px; color:#fff; font-weight:bold; }
.btn-answer { background:#3a5a98; }
.btn-nav { background:#556d98; }

.qpanelCollapsed{
  position:fixed;
  bottom:0;
  left:50%;
  transform:translateX(-50%);
  padding:6px 12px;
  cursor:pointer;
  background:#ff6f61;
  color:#fff;
  border-radius:4px;
  font-weight:bold;
  display:flex;
  align-items:center;
  z-index:21;
  font-size:13px;
}
.qpanelExpanded{
  display:none;
  position:fixed;
  bottom:30px;
  left:50%;
  transform:translateX(-50%);
  padding:10px;
  border-radius:6px;
  background:#1a1a1a;
  color:#fff;
  max-width:800px;
  overflow-y:auto;
  font-size:14px;
  text-align:center;
  z-index:20;
  max-height:300px;
}
.qgrid{ display:grid; grid-template-columns:repeat(8,1fr); gap:6px; justify-content:center; margin-top:5px; }
.qnum-box{ padding:8px; text-align:center; cursor:pointer; border-radius:4px; background:#333; color:#fff; font-weight:bold; }
.qnum-box.attempted{ background:#ff6f61; color:#fff; }
.qnum-box:hover{ opacity:0.8; }

/* locked look */
.locked { opacity:0.65; pointer-events:none; }

/* Mobile */
@media (max-width: 768px) {
  .passage { font-size:15px; margin-bottom:15px; }
  #stem { font-size:15px; margin-bottom:10px; }
  #options label { font-size:14px; }
  .bottom-bar { flex-direction:column; gap:8px; }
  .btn-answer, .btn-nav { width:100%; text-align:center; }
  .qpanelCollapsed { font-size:12px; padding:5px 10px; }
  .qpanelExpanded { max-height:250px; font-size:13px; padding:8px; }
  .qgrid { grid-template-columns:repeat(4,1fr); gap:4px; }
  .qnum-box { padding:6px; font-size:12px; }
  img { max-width:100%; height:auto; }
  .container { padding-bottom:190px; }
}
@media only screen and (max-width: 600px) {
  .bottom-bar { flex-direction:column; align-items:stretch; gap:8px; }
  #qpanelCollapsed { left:10px; bottom:80px; transform:none; font-size:12px; }
  #qpanelExpanded { left:10px; bottom:120px; transform:none; max-width:calc(100% - 20px); font-size:13px; max-height:250px; }
}
</style>
</head>

<body>

<div class="top-bar">
  <div class="top-left">
    <button id="testModeBtn" class="test-btn">Test Mode: OFF</button>
  </div>

  <div class="top-title">Math – Set 8</div>

  <div class="top-right">
    <button id="openCalculator" class="calc-btn">Calculator</button>
  </div>
</div>

<div class="container">
  <div id="qnumBox" class="qbox"></div>
  <div id="passage" class="passage"></div>
  <div id="stem"></div>
  <div id="options" class="options"></div>
  <div id="resultText" class="resultText" style="display:none;"></div>
</div>

<div class="bottom-bar">
  <button id="answerBtn" class="btn-answer">Show Correct Answer</button>
  <button id="prevBtn" class="btn-nav">Previous</button>
  <button id="nextBtn" class="btn-nav">Next</button>
  <button id="reviewBtn" class="btn-nav" style="background:#28a745;">Go to Review</button>
</div>

<div id="qpanel">
  <div id="qpanelCollapsed" class="qpanelCollapsed">
    <span id="currentQuestionLabel">Question</span>
    <span id="toggleArrow" style="margin-left:6px;">▲</span>
  </div>
  <div id="qpanelExpanded" class="qpanelExpanded">
    <div id="qgrid" class="qgrid"></div>
  </div>
</div>

<script>
document.getElementById('openCalculator').addEventListener('click', function() {
  window.open(
    'https://www.desmos.com/testing/collegeboard/graphing',
    'CalculatorWindow',
    'width=900,height=600,top=100,left=100,resizable=yes,scrollbars=yes'
  );
});

/* typeset */
function typesetMath() {
  if (window.MathJax && MathJax.typesetPromise) {
    const nodes = [
      document.getElementById('passage'),
      document.getElementById('options'),
      document.getElementById('stem'),
      document.getElementById('resultText'),
      document.getElementById('reviewPage')
    ].filter(Boolean);
    MathJax.typesetClear(nodes);
    MathJax.typesetPromise(nodes);
  }
}

// ===== numeric equivalence (SPR) =====
function toNumber(value) {
  if (value == null) return null;
  let s = value.toString().trim();
  s = s.replace(/\s+/g, "");
  s = s.replace(/\u2212/g, "-");

  const frac = s.match(/^(-?\d+(\.\d+)?)\/(-?\d+(\.\d+)?)$/);
  if (frac) {
    const n = parseFloat(frac[1]);
    const d = parseFloat(frac[3]);
    if (d !== 0) return n / d;
  }
  const num = parseFloat(s);
  return isNaN(num) ? null : num;
}
function numbersEqual(a,b,t=0.0001){
  if(a==null||b==null) return false;
  return Math.abs(a-b) < t;
}
function isCorrectAnswer(idx, givenRaw) {
  const q = questions[idx];
  const correct = q.answer;

  const givenStr = (givenRaw ?? "").toString().trim();
  if (!givenStr) return false;

  if (q.options) return givenStr === (correct ?? "").toString().trim();

  const givenNum = toNumber(givenStr);
  if (Array.isArray(correct)) return correct.some(c => numbersEqual(toNumber(c), givenNum));
  return numbersEqual(toNumber(correct), givenNum);
}

// ==== QUESTIONS (Set 8) ====
const questions = [
  { num:235, passage:`<div style="font-size:18px; font-weight:bold; margin-bottom:6px;">\\(10(15x-9)=-15(6-10x)\\)</div>How many solutions does the equation above have?`, stem:"", options:{A:"Exactly one",B:"Exactly two",C:"Infinitely many",D:"Zero"}, answer:"C", img:null },
  { num:236, passage:`In the \\(xy\\)-plane, line \\(k\\) intersects the \\(y\\)-axis at the point \\((0,-6)\\) and passes through the point \\((2,2)\\). If the point \\((20,w)\\) lies on line \\(k\\), what is the value of \\(w\\)?`, stem:"", options:null, answer:"74", img:null },
  { num:237, passage:`Circle \\(A\\) in the \\(xy\\)-plane has the equation \\((x+5)^2+(y-5)^2=4\\). Circle \\(B\\) has the same center as circle \\(A\\). The radius of circle \\(B\\) is two times the radius of circle \\(A\\). The equation defining circle \\(B\\) is \\((x+5)^2+(y-5)^2=k\\). What is \\(k\\)?`, stem:"", options:null, answer:"16", img:null },
  { num:238, passage:`The three points shown define a circle. The circumference of this circle is \\(k\\pi\\). What is \\(k\\)?`, stem:"", options:null, answer:"8", img:"238.png" },
  { num:239, passage:`The mean score of 8 players was 14.5. If the highest score is removed, the mean of the remaining 7 becomes 12. What was the highest score?`, stem:"", options:{A:"20",B:"24",C:"32",D:"36"}, answer:"C", img:null },
  { num:240, passage:`The scatterplot shows ice cream sales \\(d\\) and high temperature \\(t\\). A line of best fit is shown. Which could be an equation of the line?`, stem:"", options:{A:`\\(d=0.03t+402\\)`,B:`\\(d=10t+402\\)`,C:`\\(d=33t+300\\)`,D:`\\(d=33t+84\\)`}, answer:"D", img:"240.png" },
  { num:241, passage:`<div style="font-size:18px; font-weight:bold; margin-bottom:6px;">\\(\\frac{2}{x-2}+\\frac{3}{x+5}=\\frac{rx+t}{(x-2)(x+5)}\\)</div>The equation is true for all \\(x>2\\). What is \\(rt\\)?`, stem:"", options:{A:"-20",B:"15",C:"20",D:"60"}, answer:"C", img:null },
  { num:242, passage:`A culture of bacteria is growing exponentially as shown in the table. On which day would it reach \\(5.12\\times10^8\\)?`, stem:"", options:{A:"Day 5",B:"Day 9",C:"Day 11",D:"Day 12"}, answer:"D", img:"242.png" },
  { num:243, passage:`\\(7g+7b=840\\) for green tiles \\(g\\) and blue tiles \\(b\\). If \\(b=71\\), how many green tiles?`, stem:"", options:null, answer:"49", img:null },
  { num:244, passage:`<div style="font-size:18px; font-weight:bold; margin-bottom:6px;">\\(y\\le x\\)<br>\\(y\\le -x\\)</div>Which ordered pair is a solution?`, stem:"", options:{A:`\\((1,0)\\)`,B:`\\((-1,0)\\)`,C:`\\((0,1)\\)`,D:`\\((0,-1)\\)`}, answer:"D", img:null },
  { num:245, passage:`A right circular cylinder has height 8 m and radius 12 m. What is its volume in \\(m^3\\)?`, stem:"", options:{A:`\\(8\\pi\\)`,B:`\\(20\\pi\\)`,C:`\\(768\\pi\\)`,D:`\\(1{,}152\\pi\\)`}, answer:"D", img:null },
  { num:246, passage:`Triangles \\(ABC\\) and \\(DEF\\) are shown. Which is equal to \\(\\frac{BC}{AB}\\)?`, stem:"", options:{A:`\\(\\frac{DE}{DF}\\)`,B:`\\(\\frac{DF}{DE}\\)`,C:`\\(\\frac{DF}{EF}\\)`,D:`\\(\\frac{EF}{DE}\\)`}, answer:"B", img:"246.png" },
  { num:247, passage:`Which is true about \\(2^x\\) and \\(2x+2\\) for \\(x>0\\)?`, stem:"", options:{
      A:"For all \\(x>0\\), \\(2^x<2x+2\\).",
      B:"For all \\(x>0\\), \\(2^x>2x+2\\).",
      C:"There is \\(c\\) such that if \\(0<x<c\\) then \\(2^x<2x+2\\), but if \\(x>c\\) then \\(2^x>2x+2\\).",
      D:"There is \\(c\\) such that if \\(0<x<c\\) then \\(2^x>2x+2\\), but if \\(x>c\\) then \\(2^x<2x+2\\)."
    }, answer:"C", img:null },
  { num:248, passage:`1,250 people attended session 1. 72% attended session 2. 36% of those who attended session 1 and 2 attended session 3. How many attended all three?`, stem:"", options:null, answer:"324", img:null },
  { num:249, passage:`<div style="font-size:18px; font-weight:bold; margin-bottom:6px;">\\((x-4)(x+2)(x-1)=0\\)</div>What is the product of the solutions?`, stem:"", options:{A:"8",B:"3",C:"-3",D:"-8"}, answer:"D", img:null },
  { num:250, passage:`<div style="font-size:18px; font-weight:bold; margin-bottom:6px;">\\(\\frac{2(x+1)}{x+5}=1-\\frac{1}{x+5}\\)</div>What is the solution?`, stem:"", options:{A:"0",B:"2",C:"3",D:"5"}, answer:"B", img:null }
];

// ==== STATE ====
let currentQ = 0;
let answerShown = false;
let attempted = Array(questions.length).fill(false);
let userAnswers = Array(questions.length).fill(null);

/* Test mode state */
let isTestMode = false;
let isSubmitted = false;

function isAttemptLocked(){ return isTestMode && isSubmitted; }

function updateModeUI(){
  const answerBtn = document.getElementById('answerBtn');
  const reviewBtn = document.getElementById('reviewBtn');

  if(isTestMode && !isSubmitted){
    answerBtn.style.display = 'none';
    reviewBtn.innerText = 'Final Submit';
  } else {
    answerBtn.style.display = 'inline-block';
    reviewBtn.innerText = 'Go to Review';
  }
}

function renderResultText(){
  const box = document.getElementById('resultText');
  if(!(isTestMode && isSubmitted)){
    box.style.display='none';
    box.innerHTML='';
    return;
  }
  const q = questions[currentQ];
  const your = (userAnswers[currentQ] ?? '').toString().trim() || '-';
  const correct = Array.isArray(q.answer) ? q.answer.join(" or ") : q.answer;

  box.style.display='block';
  box.innerHTML = `
    <div class="resultLine yourAns">Your answer: ${your}</div><br>
    <div class="resultLine correctAns">Correct answer: ${correct}</div>
  `;
  typesetMath();
}

function loadQuestion(){
  const q = questions[currentQ];

  // passage + optional image
  if(q.img){
    document.getElementById('passage').innerHTML = `
      <img src="${q.img}" alt="Graph"
           style="max-width:400px; width:100%; height:auto; display:block; margin-bottom:12px;">
      ${q.passage}
    `;
  } else {
    document.getElementById('passage').innerHTML = q.passage;
  }

  document.getElementById('qnumBox').innerText = `Q${q.num}`;
  document.getElementById('stem').innerText = q.stem || "";

  const optionsDiv = document.getElementById('options');
  optionsDiv.innerHTML = '';

  // MCQ
  if(q.options){
    for(const [key,val] of Object.entries(q.options)){
      const lbl = document.createElement('label');
      lbl.innerHTML = `<input type="radio" name="option" value="${key}"> ${key}. ${val}`;
      const input = lbl.querySelector('input');

      if(userAnswers[currentQ] === key) input.checked = true;

      input.addEventListener('change', ()=>{
        if(isAttemptLocked()) return;
        userAnswers[currentQ] = key;
        attempted[currentQ] = true;
        updateQpanel();
        renderResultText();
      });

      if(isAttemptLocked()){
        input.disabled = true;
        lbl.classList.add('locked');
      }

      optionsDiv.appendChild(lbl);
    }
  } else {
    // SPR
    const wrap = document.createElement('div');
    wrap.className = 'spr-wrap';
    wrap.innerHTML = `
      <input id="sprInput" class="spr-input" type="text" inputmode="decimal" />
      <div id="sprAnswerReveal" class="spr-hint"></div>
    `;
    optionsDiv.appendChild(wrap);

    const sprInput = document.getElementById('sprInput');
    if(userAnswers[currentQ] !== null) sprInput.value = userAnswers[currentQ];

    sprInput.addEventListener('input', ()=>{
      if(isAttemptLocked()) return;
      userAnswers[currentQ] = sprInput.value.trim();
      attempted[currentQ] = userAnswers[currentQ].length > 0;
      updateQpanel();
      renderResultText();
    });

    if(isAttemptLocked()){
      sprInput.disabled = true;
      wrap.classList.add('locked');
    }
  }

  answerShown = false;
  document.getElementById('answerBtn').innerText = 'Show Correct Answer';

  updateQpanel();
  updateModeUI();
  renderResultText();
  typesetMath();
}

function toggleAnswer(){
  if(isTestMode && !isSubmitted) return;

  const q = questions[currentQ];
  const optionsDiv = document.getElementById('options');

  if(!answerShown){
    if(q.options){
      for(const input of optionsDiv.querySelectorAll('input[type="radio"]')){
        input.parentNode.classList.remove('correct','incorrect');
        if(input.value === q.answer) input.parentNode.classList.add('correct');
        else input.parentNode.classList.add('incorrect');
      }
    } else {
      const reveal = document.getElementById('sprAnswerReveal');
      if(reveal){
        const ans = Array.isArray(q.answer) ? q.answer.join(" or ") : q.answer;
        reveal.innerHTML = `<strong>Correct Answer:</strong> ${ans}`;
      }
    }
    document.getElementById('answerBtn').innerText = 'Hide Correct Answer';
    answerShown = true;
  } else {
    if(q.options){
      for(const input of optionsDiv.querySelectorAll('input[type="radio"]')){
        input.parentNode.classList.remove('correct','incorrect');
      }
    } else {
      const reveal = document.getElementById('sprAnswerReveal');
      if(reveal) reveal.innerHTML = '';
    }
    document.getElementById('answerBtn').innerText = 'Show Correct Answer';
    answerShown = false;
  }
}

document.getElementById('answerBtn').addEventListener('click', toggleAnswer);
document.getElementById('prevBtn').addEventListener('click', ()=>{ if(currentQ>0) currentQ--; loadQuestion(); });
document.getElementById('nextBtn').addEventListener('click', ()=>{ if(currentQ<questions.length-1) currentQ++; loadQuestion(); });

const collapsed = document.getElementById('qpanelCollapsed');
const expanded = document.getElementById('qpanelExpanded');
collapsed.addEventListener('click', ()=>{ expanded.style.display = (expanded.style.display==='block')?'none':'block'; });

function updateQpanel(){
  const grid = document.getElementById('qgrid');
  grid.innerHTML = '';
  questions.forEach((q,i)=>{
    const b = document.createElement('div');
    b.innerText = q.num;
    b.className = 'qnum-box';
    b.classList.toggle('attempted', attempted[i]);
    b.addEventListener('click', ()=>{ currentQ=i; loadQuestion(); expanded.style.display='none'; });
    grid.appendChild(b);
  });
  document.getElementById('currentQuestionLabel').innerText = `Question ${questions[currentQ].num} of ${questions.length}`;
}

function openReviewPage(){
  const mainContent = document.querySelector('.container');
  const bottomBar = document.querySelector('.bottom-bar');
  const qpanel = document.getElementById('qpanel');

  mainContent.style.display = 'none';
  bottomBar.style.display = 'none';
  qpanel.style.display = 'none';

  let reviewDiv = document.getElementById('reviewPage');
  if(!reviewDiv){
    reviewDiv = document.createElement('div');
    reviewDiv.id = 'reviewPage';
    reviewDiv.style.padding = '20px';
    reviewDiv.style.maxWidth = '600px';
    reviewDiv.style.margin = '0 auto';
    document.body.appendChild(reviewDiv);
  }
  reviewDiv.style.display = 'block';
  reviewDiv.innerHTML = '<h2>Review Questions</h2>';

  const correctCount = userAnswers.filter((ans, idx) => isCorrectAnswer(idx, ans)).length;
  const totalCount = questions.length;

  const scoreDiv = document.createElement('div');
  scoreDiv.style.fontWeight = 'bold';
  scoreDiv.style.marginBottom = '15px';
  scoreDiv.innerText = `Score: ${correctCount} / ${totalCount}`;
  reviewDiv.appendChild(scoreDiv);

  const ul = document.createElement('ul');
  ul.style.listStyle='none';
  ul.style.padding='0';
  ul.style.display='flex';
  ul.style.flexWrap='wrap';
  ul.style.gap='8px';

  questions.forEach((q,i)=>{
    const li = document.createElement('li');
    li.innerText = q.num;
    li.style.padding='8px 12px';
    li.style.border='1px solid #333';
    li.style.borderRadius='4px';
    li.style.cursor='pointer';
    li.style.color='#fff';

    const given = (userAnswers[i] ?? "").toString().trim();
    if(!given) li.style.background = '#555';
    else if(isCorrectAnswer(i, given)) li.style.background = '#28a745';
    else li.style.background = '#dc3545';

    li.addEventListener('click', ()=>{
      currentQ = i;
      loadQuestion();
      reviewDiv.style.display='none';
      mainContent.style.display='flex';
      bottomBar.style.display='flex';
      qpanel.style.display='block';
    });

    ul.appendChild(li);
  });

  reviewDiv.appendChild(ul);

  let backBtn = document.getElementById('backToTestBtn');
  if(!backBtn){
    backBtn = document.createElement('button');
    backBtn.id = 'backToTestBtn';
    backBtn.innerText = 'Back to Test';
    backBtn.style.background='#556d98';
    backBtn.style.color='#fff';
    backBtn.style.border='none';
    backBtn.style.padding='10px 20px';
    backBtn.style.marginTop='20px';
    backBtn.style.borderRadius='4px';
    backBtn.style.cursor='pointer';
    reviewDiv.appendChild(backBtn);
  }

backBtn.onclick = ()=>{
  reviewDiv.style.display='none';
  mainContent.style.display='flex';
  bottomBar.style.display='flex';
  qpanel.style.display='block';

  // ✅ IMPORTANT: re-render current question so lock + buttons + result bars apply
  loadQuestion();
};
  typesetMath();
}

document.getElementById('reviewBtn').addEventListener('click', ()=>{
  if(isTestMode && !isSubmitted){
    const ok = confirm("Final Submit?\nAfter submission, answers will be locked.");
    if(ok){
      isSubmitted = true;
      updateModeUI();
      openReviewPage();
    }
    return;
  }
  openReviewPage();
});

document.getElementById('testModeBtn').addEventListener('click', ()=>{
  if(!isTestMode){
    isTestMode = true;
    isSubmitted = false;

    // fresh attempt
    attempted = Array(questions.length).fill(false);
    userAnswers = Array(questions.length).fill(null);
    currentQ = 0;
    answerShown = false;

    document.getElementById('testModeBtn').innerText = 'Test Mode: ON';
    alert("Test Mode is ON.\n- Correct answers hidden until Final Submit.\n- Review allowed only after Final Submit.\n- Fresh attempt started.");
    updateModeUI();
    loadQuestion();
    return;
  }

  // if already submitted, allow restart test without turning off
  if(isSubmitted){
    const ok = confirm("Start a new test attempt? This will clear all your answers.");
    if(ok){
      isSubmitted = false;
      attempted = Array(questions.length).fill(false);
      userAnswers = Array(questions.length).fill(null);
      currentQ = 0;
      answerShown = false;

      // ensure review page hidden
      const reviewDiv = document.getElementById('reviewPage');
      if(reviewDiv) reviewDiv.style.display = 'none';
      document.querySelector('.container').style.display='flex';
      document.querySelector('.bottom-bar').style.display='flex';
      document.getElementById('qpanel').style.display='block';

      updateModeUI();
      loadQuestion();
    }
    return;
  }

  // turn OFF test mode (practice)
  isTestMode = false;
  isSubmitted = false;
  document.getElementById('testModeBtn').innerText = 'Test Mode: OFF';

  // hide review if open
  const reviewDiv = document.getElementById('reviewPage');
  if(reviewDiv) reviewDiv.style.display = 'none';
  document.querySelector('.container').style.display='flex';
  document.querySelector('.bottom-bar').style.display='flex';
  document.getElementById('qpanel').style.display='block';

  updateModeUI();
  loadQuestion();
  alert("Test Mode is OFF.\nPractice Mode enabled.");
});

// init
loadQuestion();
updateModeUI();
</script>

</body>
</html>
